const resultsLoc=document.querySelector(".results"),branchesLoc=document.querySelector(".branches"),jobFormLoc=document.querySelector(".job-form"),jobTypeLoc=document.querySelector(".job-type"),langLoc=document.querySelector(".lang"),countriesLoc=document.querySelector(".countries"),citiesLoc=document.querySelector(".cities"),sliderOne=document.getElementById("slider-1"),sliderTwo=document.getElementById("slider-2"),displayValOne=document.getElementById("range1"),displayValTwo=document.getElementById("range2"),sliderTrack=document.querySelector(".salary .slider-track"),pauseLoc=document.querySelector(".salary .pause"),recNumLoc=document.querySelector(".records-number"),searchBtn=document.querySelector(".search-btn"),remoteLoc=document.querySelector("#remote"),relocationLoc=document.querySelector("#relocation"),salaryMarkLoc=document.querySelector("#salary-mark"),salarySliderLoc=document.querySelector(".salary .slider-container .container"),salaryValuesLoc=document.querySelector(".salary .slider-values"),salaryMinDotLoc=document.querySelector("#slider-1"),salaryMaxDotLoc=document.querySelector("#slider-2"),searchInputLoc=document.querySelector(".search-input input"),clearFiltersLoc=document.querySelector(".clear-filters"),clearFilterLoc=document.querySelectorAll(".lists .clear-list"),noResultsLoc=document.querySelector(".no-results"),dropDownFilterLoc=document.querySelector(".drop-down-filters"),dropDownLoc=document.querySelector(".drop-down-btn"),dropDownBtnLoc=document.querySelector(".drop-down-btn img"),moreFiltersLoc=document.querySelector(".more-filters"),lessFiltersLoc=document.querySelector(".less-filters"),locationMarkLoc=document.querySelector("#localization"),locationSliderLoc=document.querySelector(".distance-slider .slider-container .container"),locationDotLoc=document.querySelector("#loc-slider"),locationValuesLoc=document.querySelector(".distance-slider .slider-values"),displayValThree=document.getElementById("range3"),recordsOnPageLoc=document.querySelectorAll(".recordsOnPage span"),pagesContainerLoc=document.querySelector(".pages-container");let pageButtonsLoc=document.querySelectorAll(".page"),apiPage=1,recordsOnPage=20,apiDataLength=0,i=1,k=recordsOnPage,filterBranchesList=[],filterJobFormList=[],filterJobTypeList=[],filterLangList=[],filterMinSalary=1e5,filterMaxSalary=0,filterCountriesList={},recordsNumber=0,isEmpty=!0,filterObj={},filterListMaxHeight=0,allowSetPages=!0;remoteLoc.checked=!1,relocationLoc.checked=!1,salaryMarkLoc.checked=!1,salaryMinDotLoc.disabled=!0,salaryMaxDotLoc.disabled=!0,salaryMarkLoc.addEventListener("change",(function(e){e.target.checked?(salarySliderLoc.classList.remove("unactive"),salaryValuesLoc.classList.remove("unactive"),salaryMinDotLoc.disabled=!1,salaryMaxDotLoc.disabled=!1):(salarySliderLoc.classList.add("unactive"),salaryValuesLoc.classList.add("unactive"),salaryMinDotLoc.disabled=!0,salaryMaxDotLoc.disabled=!0)}));const getAPI=e=>new Promise((t=>{t(fetch("https://grupaprogres.traffit.com/public/job_posts/published",{mode:"cors",headers:{"Content-Type":"application/json","X-Request-Page-Size":"100","X-Request-Current-Page":e,"X-Request-Sort":'{"sort_by": "id", "direction": "ASC"}'}}))})),getAPIJSON=e=>new Promise((t=>{t(e.json())})),getAPIJSONLen=e=>new Promise((t=>{t({apiArray:e,apiArrayLen:e.length})})),getAPIPage=(e,t)=>{getAPI(e).then((e=>getAPIJSON(e))).then((e=>getAPIJSONLen(e))).then((o=>{if(apiDataLength=o.apiArrayLen,apiDataLength>0)1===e&&(resultsLoc.replaceChildren(),recordsNumber=0),showDataInHtml(o.apiArray,t);else{function i(e,t){return e.city.localeCompare(t.city)}isEmpty&&filterHTML(filterBranchesList,filterJobFormList,filterJobTypeList,filterLangList,filterMinSalary,filterMaxSalary),recNumLoc.innerText=`Znaleziono ${recordsNumber} ogłoszeń`,recordsNumber?noResultsLoc.classList.remove("active"):noResultsLoc.classList.add("active"),setPages(recordsNumber);for(let r in filterCountriesList)filterCountriesList[r].sort(i)}}))};getAPIPage(apiPage,filterObj),i=1;const showDataInHtml=(e,t)=>{let o;isEmpty=0===Object.keys(t).length,e.forEach((function(e){if(console.log("All "+i),console.log("All "+k),e.options.job_location&&(o=JSON.parse(e.options.job_location)),isEmpty)-1===filterBranchesList.findIndex((t=>t===e.options.branches))&&filterBranchesList.push(e.options.branches),e.options._forma_zatrudnienia&&e.options._forma_zatrudnienia.forEach((function(e){-1===filterJobFormList.findIndex((t=>t===e))&&filterJobFormList.push(e)})),-1===filterJobTypeList.findIndex((t=>t===e.options.job_type))&&filterJobTypeList.push(e.options.job_type),-1===filterLangList.findIndex((t=>t===e.advert.language))&&filterLangList.push(e.advert.language),parseInt(e.options._Widoczna_stawka)&&(parseInt(e.options._spodziewane_wynagrodzenie_od)<filterMinSalary&&(filterMinSalary=e.options._spodziewane_wynagrodzenie_od),parseInt(e.options._spodziewane_wynagrodzenie_do)>filterMaxSalary&&(filterMaxSalary=e.options._spodziewane_wynagrodzenie_do)),filterCountriesList[o.country]?-1===filterCountriesList[o.country].findIndex((e=>e.city===o.locality))&&filterCountriesList[o.country].push({city:o.locality,lati:parseFloat(o.latitude),longi:parseFloat(o.longitude)}):(filterCountriesList[o.country]=[],filterCountriesList[o.country].push({city:o.locality,lati:parseFloat(o.latitude),longi:parseFloat(o.longitude)}));else{if(t.branchesFiltr.length&&-1===t.branchesFiltr.indexOf(e.options.branches)&&t.branchesFiltr.length)return!1;if(t.jobFormsFiltr.length){let o=!1;if(!e.options._forma_zatrudnienia)return!1;if(e.options._forma_zatrudnienia.forEach((function(e){t.jobFormsFiltr.length&&-1!==t.jobFormsFiltr.indexOf(e)&&(o=!0)})),!o)return!1}if(t.jobTypesFiltr.length&&-1===t.jobTypesFiltr.indexOf(e.options.job_type)&&t.jobTypesFiltr.length)return!1;if(t.langsFiltr.length&&-1===t.langsFiltr.indexOf(e.advert.language)&&t.langsFiltr.length)return!1;if(t.remoteFiltr&&!e.options.remote)return!1;if(t.relocationFiltr&&!e.options._relokacja)return!1;if(t.salary[0]||t.salary[1]){if(1!=e.options._Widoczna_stawka)return!1;if(e.options._spodziewane_wynagrodzenie_od&&e.options._spodziewane_wynagrodzenie_do){if(t.salary[0]<e.options._spodziewane_wynagrodzenie_od&&t.salary[1]<e.options._spodziewane_wynagrodzenie_od)return!1;if(t.salary[0]>e.options._spodziewane_wynagrodzenie_do&&t.salary[1]>e.options._spodziewane_wynagrodzenie_do)return!1}if(e.options._spodziewane_wynagrodzenie_od&&!e.options._spodziewane_wynagrodzenie_do&&t.salary[0]<e.options._spodziewane_wynagrodzenie_od&&t.salary[1]<e.options._spodziewane_wynagrodzenie_od)return!1;if(!e.options._spodziewane_wynagrodzenie_od&&e.options._spodziewane_wynagrodzenie_do&&t.salary[0]>e.options._spodziewane_wynagrodzenie_do&&t.salary[1]>e.options._spodziewane_wynagrodzenie_do)return!1}if(t.searchText){let o=!1,i=-1;if(e.advert.values.forEach((function(e){e.value&&"geolocation"!==e.field_id&&(i=e.value.toLowerCase().search(t.searchText.toLowerCase()),-1!==i&&(o=!0))})),i=e.advert.name.toLowerCase().search(t.searchText.toLowerCase()),-1!==i&&(o=!0),!o)return!1}if(t.countriesFiltr[0]&&-1===t.countriesFiltr.indexOf(o.country)&&o.country)return!1;if(t.citiesFiltr[0]&&-1===t.citiesFiltr.indexOf(o.locality)&&o.locality&&citiesLoc.value){let e=parseFloat(o.latitude),i=parseFloat(o.longitude),r=t.distanceFiltr,n=t.latiFiltr-.009044*r,a=t.latiFiltr+.009044*r,l=t.longiFiltr-.0089831*r/Math.cos(t.latiFiltr*Math.PI/180),s=t.longiFiltr+.0089831*r/Math.cos(t.latiFiltr*Math.PI/180);if(e>a||e<n||i>s||i<l)return!1}}recordsNumber++;let r="",n="";"PT"===e.options._rekrutacja_rodzaj&&(r="pt-border",n="pt-text"),"RS"===e.options._rekrutacja_rodzaj&&(r="rs-border",n="rs-text"),"WEW"===e.options._rekrutacja_rodzaj&&(r="wew-border",n="wew-text");let a="";e.options._forma_zatrudnienia&&e.options._forma_zatrudnienia.forEach((function(e){a=a+"<p>"+e+"</p>"})),i<=k&&(console.log("In cond "+i),console.log("In cond "+k),resultsLoc.insertAdjacentHTML("beforeend",`<a href="${e.url}" target="_blank"><div class="result ${r}">\n                <div class="top">\n                    <div class="top-left">\n                        <div class="lang"><p>${e.advert.language}</p></div>\n                        <div class="branche-name">\n                            <div class="branche">${e.options.branches?e.options.branches:""}</div>\n                            <div class="name ${n}">${e.advert.name}</div>\n                        </div>\n                    </div>\n                    <div class="top-right">\n                        ${e.options.job_type?"<div class='jobtype'>"+e.options.job_type+"</div>":""}\n                        ${e.options._Widoczna_stawka&&e.options._spodziewane_wynagrodzenie_od&&e.options._spodziewane_wynagrodzenie_do?"<div class='salary'>"+e.options._spodziewane_wynagrodzenie_od+" - "+e.options._spodziewane_wynagrodzenie_do+"</div>":""}\n                    </div>\n                </div>\n\n                <div class="bottom">\n                    <div class="bottom-left">\n                        <div class="city"><img src="./img/location_dot.svg">${o.locality}</div>\n                        ${e.options.remote?"<div class='remote'>zdalna</div>":""}\n                        ${e.options._relokacja?"<div class='relocation'>relocation</div>":""}\n                    </div>\n                        <div class="bottom-right">\n                            <div class="employmentform">${a}</div>\n                        </div>\n                    </div>\n                </div>\n\n            </div></a>`)),i++})),getAPIPage(++apiPage,t)},filterHTML=()=>{if(filterBranchesList.length>0&&(filterBranchesList.sort((function(e,t){return e.localeCompare(t)})),rowHeight=21*filterBranchesList.length+3,filterListMaxHeight=rowHeight,branchesLoc.style.height=String(rowHeight)+"px",filterBranchesList.forEach((function(e){branchesLoc.insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)}))),filterJobFormList.length>0&&(filterJobFormList.sort((function(e,t){return e.localeCompare(t)})),rowHeight=21*filterJobFormList.length+3,jobFormLoc.style.height=String(rowHeight)+"px",filterJobFormList.forEach((function(e){jobFormLoc.insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)}))),filterJobTypeList.length>0&&(filterJobTypeList.sort((function(e,t){return e.localeCompare(t)})),rowHeight=21*filterJobTypeList.length+3,jobTypeLoc.style.height=String(rowHeight)+"px",filterJobTypeList.forEach((function(e){jobTypeLoc.insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)}))),filterLangList.length>0&&(filterLangList.sort((function(e,t){return e.localeCompare(t)})),rowHeight=21*filterLangList.length+3,langLoc.style.height=String(rowHeight)+"px",filterLangList.forEach((function(e){langLoc.insertAdjacentHTML("beforeend",`<option value="${e}">${e}</option>`)}))),Object.keys(filterCountriesList).length>0){const e=Object.keys(filterCountriesList).sort().reduce(((e,t)=>(e[t]=filterCountriesList[t],e)),{});countriesLoc.insertAdjacentHTML("beforeend",'<option value="" class="placeholder">Państwo</option>');let t=[];for(let o in e)countriesLoc.insertAdjacentHTML("beforeend",`<option value="${o}">${o}</option>`),t=t.concat(e[o]);let o=[];t.forEach((e=>{o.push(e.city)})),o.sort((function(e,t){return e.localeCompare(t)})),citiesLoc.insertAdjacentHTML("beforeend",'<option value="" class="placeholder">Miasto</option>'),o.forEach((function(e){citiesLoc.insertAdjacentHTML("beforeend",`<option value="${e}" class="active">${e} </option>`)}))}Object.keys(filterObj).length,sliderOne.value=filterMinSalary,sliderTwo.value=filterMaxSalary,sliderOne.min=filterMinSalary,sliderTwo.min=filterMinSalary,sliderOne.max=filterMaxSalary,sliderTwo.max=filterMaxSalary,slideOne(),slideTwo()};let minGap=0;function slideOne(){parseInt(sliderTwo.value)-parseInt(sliderOne.value)<=minGap&&(sliderOne.value=parseInt(sliderTwo.value)-minGap),displayValOne.textContent=sliderOne.value,fillColor()}function slideTwo(){parseInt(sliderTwo.value)-parseInt(sliderOne.value)<=minGap&&(sliderTwo.value=parseInt(sliderOne.value)+minGap),displayValTwo.textContent=sliderTwo.value,"100000"===displayValOne.textContent&&(salaryMarkLoc.disabled=!0,displayValOne.textContent="",displayValTwo.textContent="",pauseLoc.textContent=""),fillColor()}function fillColor(){percent1=(sliderOne.value-sliderOne.min)/(sliderOne.max-sliderOne.min)*100,percent2=(sliderTwo.value-sliderOne.min)/(sliderOne.max-sliderOne.min)*100,sliderTrack.style.background=`linear-gradient(to right, #dadae5 ${percent1}%, #fe7320ff ${percent1}%, #fe7320ff ${percent2}%, #dadae5 ${percent2}%)`}slideOne(),slideTwo();const getFilteredData=()=>{const e=document.querySelectorAll(".branches option"),t=document.querySelectorAll(".job-form option"),o=document.querySelectorAll(".job-type option"),i=document.querySelectorAll(".lang option"),r=document.querySelectorAll(".countries option"),n=document.querySelectorAll(".cities option");filterObj={};let a=Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value})),l=Array.from(t).filter((function(e){return e.selected})).map((function(e){return e.value})),s=Array.from(o).filter((function(e){return e.selected})).map((function(e){return e.value})),c=Array.from(i).filter((function(e){return e.selected})).map((function(e){return e.value})),d=[];locationMarkLoc.checked&&(d=Array.from(r).filter((function(e){return e.selected})).map((function(e){return e.value})));let u,L,p=[];locationMarkLoc.checked&&(p=Array.from(n).filter((function(e){return e.selected})).map((function(e){return e.value}))),p[0]&&(u=filterCountriesList[d[0]].find((e=>e.city===p[0])).lati,L=filterCountriesList[d[0]].find((e=>e.city===p[0])).longi);let f=0;locationMarkLoc.checked&&(f=parseInt(locationDotLoc.value));let y,g,m=remoteLoc.checked,v=relocationLoc.checked;salaryMarkLoc.checked&&(y=displayValOne.innerText,g=displayValTwo.innerText),filterObj.branchesFiltr=a,filterObj.jobFormsFiltr=l,filterObj.jobTypesFiltr=s,filterObj.langsFiltr=c,filterObj.remoteFiltr=m,filterObj.relocationFiltr=v,filterObj.salary=[y,g],filterObj.searchText=searchInputLoc.value,filterObj.countriesFiltr=d,filterObj.citiesFiltr=p,filterObj.distanceFiltr=f,filterObj.latiFiltr=u,filterObj.longiFiltr=L,apiPage=1,apiDataLength=0,recordsNumber=0,getAPIPage(apiPage,filterObj)};searchBtn.addEventListener("click",getFilteredData);const clearFilters=()=>{searchInputLoc.value="",window.location.reload()};function slideThree(){displayValThree.textContent=locationDotLoc.value}clearFiltersLoc.addEventListener("click",clearFilters),clearFilterLoc.forEach((e=>{e.addEventListener("click",(()=>{e.previousElementSibling.querySelectorAll("option").forEach((e=>{e.selected&&(e.selected=!1)}))}))})),dropDownLoc.addEventListener("click",(()=>{dropDownBtnLoc.classList.toggle("up"),dropDownFilterLoc.classList.contains("show")?(dropDownFilterLoc.classList.remove("show"),dropDownFilterLoc.style.maxHeight=String(0)+"px",moreFiltersLoc.classList.remove("hide"),lessFiltersLoc.classList.remove("show")):(dropDownFilterLoc.classList.add("show"),dropDownFilterLoc.style.maxHeight=String(filterListMaxHeight+200)+"px",moreFiltersLoc.classList.add("hide"),lessFiltersLoc.classList.add("show"))})),locationMarkLoc.checked=!1,locationDotLoc.disabled=!0,countriesLoc.disabled=!0,citiesLoc.disabled=!0,locationMarkLoc.addEventListener("change",(function(e){e.target.checked?(citiesLoc.value&&(locationSliderLoc.classList.remove("unactive"),locationValuesLoc.classList.remove("unactive"),locationDotLoc.disabled=!1),countriesLoc.disabled=!1,citiesLoc.disabled=!1):(locationSliderLoc.classList.add("unactive"),locationValuesLoc.classList.add("unactive"),locationDotLoc.disabled=!0,countriesLoc.disabled=!0,citiesLoc.disabled=!0)})),locationDotLoc.value=0;const activateCities=()=>{citiesLoc.querySelectorAll("option").forEach((e=>{countriesLoc.value?-1!==filterCountriesList[countriesLoc.value].findIndex((t=>t.city===e.value))?e.classList.add("active"):e.classList.remove("active"):e.classList.add("active")}))};countriesLoc.addEventListener("change",(function(){activateCities(),countriesLoc.value?filterCountriesList[countriesLoc.value].find((e=>e.city!==citiesLoc.value))&&(citiesLoc.value=filterCountriesList[countriesLoc.value][0].city,locationSliderLoc.classList.remove("unactive"),locationValuesLoc.classList.remove("unactive"),locationDotLoc.disabled=!1):(citiesLoc.value=citiesLoc[0].value,locationSliderLoc.classList.add("unactive"),locationValuesLoc.classList.add("unactive"),locationDotLoc.disabled=!0)})),citiesLoc.addEventListener("change",(function(){Object.keys(filterCountriesList).find((e=>{-1!==filterCountriesList[e].findIndex((e=>e.city===citiesLoc.value))&&countriesLoc.value!==e&&(countriesLoc.value=e,activateCities())})),citiesLoc.value?(locationSliderLoc.classList.remove("unactive"),locationValuesLoc.classList.remove("unactive"),locationDotLoc.disabled=!1):(locationSliderLoc.classList.add("unactive"),locationValuesLoc.classList.add("unactive"),locationDotLoc.disabled=!0)})),recordsOnPageLoc.forEach((e=>{e.addEventListener("click",(e=>{recordsOnPageLoc.forEach((e=>{e.classList.remove("active")})),document.querySelector(`[data-value='${e.target.dataset.value}']`).classList.add("active"),recordsOnPage=parseInt(e.target.dataset.value),allowSetPages=!0,i=1,getFilteredData()}))}));const changePage=e=>{pageButtonsLoc.forEach((e=>{e.classList.remove("active")})),e.classList.add("active"),i=recordsOnPage*(parseInt(e.innerText)-1)+1,k=recordsOnPage*(parseInt(e.innerText)-1)+recordsOnPage,allowSetPages=!1,getFilteredData()},setPages=e=>{if(allowSetPages){const t=Math.ceil(e/recordsOnPage);for(pagesContainerLoc.replaceChildren(),n=1;n<=t;n++)1===n?pagesContainerLoc.insertAdjacentHTML("beforeend",`<div class="page active">${n}</div>`):pagesContainerLoc.insertAdjacentHTML("beforeend",`<div class="page">${n}</div>`);pageButtonsLoc=document.querySelectorAll(".page"),pageButtonsLoc.forEach((e=>{e.addEventListener("click",(()=>{var t;t=e,pageButtonsLoc.forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),i=recordsOnPage*(parseInt(t.innerText)-1)+1,k=recordsOnPage*(parseInt(t.innerText)-1)+recordsOnPage,allowSetPages=!1,getFilteredData()}))}))}};
//# sourceMappingURL=all.min.js.map
